# JVM内存

## 一、说一说java 的jvm内存模型？



1.程序计数器。用来控制字节码指令的执行流程，记录线程的执行位置，以便线程之间的切换。属于线程私有。



2.Java虚拟机栈，用来存储Java局部变量，方法出口信息等，是线程私有的，会发生栈溢出异常。



3.本地方法栈，用来存储（非java语言）本地方法的局部变量，方法出口信息等，是线程私有的，会发生栈溢出异常。



4。堆，用来存储对象的实例，是gc管理的主要内存区域，是线程共享的。



5.方法区，用来存储类信息，常量，静态变量，其内部还有个运行时常量池，存储着字符串常量等，属性线程共享的。





## 二、说一说Java对象的创建过程？(new 一个对象)

1. ​           首先对对象所在的类进行类加载检查，如果该类没有加载过，就进行类加载。

2. ​          JVM给对象分配内存空间（用CAS保证分配过程的线程安全）。

3. ​	 对分配的内存空间都初始化零值。
4. ​         设置对象头，对象头里有对象的元数据信息。
5. ​         执行初始化方法。





## 三、Java对象的对象头里存储了什么信息?

1. hashcode

2. gc分代年龄

3. 锁的状态

4. 类型指针，JVM用其来确定该对象对应的类、

   

   

   # JVM垃圾回收

   

   

   

   ## 一、说一说JVM垃圾回收的分区？

   

   JVM把堆分成新生代和老年代，新生代有Eden区。Survivor区，Survivor区又分为From区和To区。

   

   

   ## 二、说一说JVM如何进行垃圾回收？

   ​	首先大部分的java对象会分配到新生代的Eden区和From区，在进行了一次新生代回收后，存活的对象的年龄会+1.年龄阈值的默认值是15，达到年龄阈值的对象就会被移动到老年区，没有达到年龄阈值的对象就会被复制到to区，并且From区和To区交换角色。如果To区满时，所有对象都会移动到老年代。如果老年代的空间不足，就会执行老年代回收。

   ​	其次，需要大量内存对象会直接被分配到老年区，比如字符串、数组等，提高效率。

   ​	

   ​	另外。如果新生代中Survivor区里相同年龄的对象占用内存的大小大于等于Survivor区的一半就直接进老年代。



## 	三、哪些对象会被JVM回收？

JVM使用可达性分析算法，选择GC roots对象为起点进行搜索而搜索不到的对象作为垃圾对象，这些对象被标记后如果在finalize方法中没有复活便会被回收。



​		

## 	四、Java的垃圾收集算法有哪些？



​		1.复制算法。新生代使用的回收算法。将内存分为大小相同的两部分，复制一部分的对象到 另一部分，并清除原来部分的内容。

​			优点效率高，缺点浪费内存空间。

​		2 标记清除算法。 先标记垃圾对象再清除。

​			优点 有效利用内存空间

​			缺点 空间会产生内存碎片

​		3.标记整理算法。在标记清除算法的基础上增加了压缩阶段，能有效解决内存碎片化的问题。



## 	五、常见的垃圾回收器有哪些

1。G1收集器

2. CMS收集器。

   （还有很多，但是比较难记，至少要回答道这两个主要的。）





## 	六、说一说G1收集器和CMS收集器



1.G1收集器，有高吞吐量的特征。它能利用CPU的多核心的特征，通过并发的方式，减少STW的停顿时间。使用复制算法和标记整理算法进行垃圾回收。并可以预测STW的停顿时间。G1收集器维护了一个优先列表，优先收集回收价值最大的区域。



2。CMS收集器。它是以获取最短的STW停顿时间为目标而产生的收集器、实现了垃圾回收线程和用户线程同步运行。使用标记清除算法进行垃圾回收。





# JVM监控





## 	一、说一说你知道哪些jdk监控JVM的命令？

1.  jps   查看java进程 （jps-l查看全名）
2. jstat 查看虚拟机的信息。
3. jinfo 实时修改虚拟机参数。
4. jmap  生成堆信息
5. jstack 生成栈信息





## 类加载器





## 一、说一说java的类加载器有哪些

1. 启动类加载器 BootstrapClassLoader，用于加载java的基本类或用 -Xbootclasspath指定的类。
2. 扩展类加载器 ExtensionClassLoader ，用于加载ext里的扩展类，或被java.ext.dirs指定的jar包。
3. 应用程序加载器ApplicationClassLoader 用于记载用户自定义的类。

   4.用户还可以自定义类加载器。

## 二、说一说什么是双亲委派机制

类加载的时候是先由最上层的父类开始依次尝试加载。能有效避免jdk被的核心类被修改和避免重复加载。



 